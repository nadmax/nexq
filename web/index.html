<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="index.css">
    <title>Nexq - Dashboard</title>
</head>
<body>
    <div class="container">
        <h1>Nexq - Dashboard</h1>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('main', this)">Tasks</button>
            <button class="tab" onclick="switchTab('dlq', this)">Dead Letter Queue</button>
            <button class="tab" onclick="switchTab('docs', this)">Docs</button>
        </div>

        <div id="main-tab" class="tab-content active">
            <div class="create-task">
                <h2>Create New Task</h2>
                <form id="taskForm">
                    <div class="task-form-layout">
                        <div class="editor-column">
                            <label>Payload (JSON)</label>
                            <div class="editor-wrapper">
                                <div id="editor"></div>
                            </div>
                        </div>
                        <div class="controls-column">
                            <div class="form-group">
                                <label>Task Type</label>
                                <select id="taskType">
                                    <option value="send_email">Send Email</option>
                                    <option value="generate_report">Generate Report</option>
                                    <option value="process_image">Process Image</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Priority</label>
                                <select id="priority">
                                    <option value="0">Low</option>
                                    <option value="1" selected>Medium</option>
                                    <option value="2">High</option>
                                </select>
                            </div>
                            <button type="submit">Create Task</button>
                        </div>
                    </div>
                </form>
            </div>

            <div class="tasks">
                <h2>Tasks</h2>
                <div id="taskList"></div>
            </div>

            <div class="stats">
                <h2>Statistics</h2>
                <div id="stats">Loading...</div>
            </div>
        </div>

        <div id="dlq-tab" class="tab-content">
            <div class="tasks">
                <h2>Failed Tasks</h2>
                <div id="dlqList"></div>
            </div>

            <div class="stats">
                <h2>Dead Letter Queue Statistics</h2>
                <div id="dlqStats">Loading...</div>
            </div>
        </div>

        <div id="docs-tab" class="tab-content">
            <div class="docs-section">
                <h3>Getting Started</h3>
                <p>Nexq is a task queue system that allows you to create, schedule, and manage background tasks. This documentation provides examples of how to interact with the Dashboard.</p>
            </div>

            <div class="docs-section">
                <h3>API Endpoints</h3>
                <table class="params-table" id="api-endpoints-table">
                    <thead>
                        <tr>
                            <th class="sortable" onclick="sortTable('api-endpoints-table', 0)">Method <span></span></th>
                            <th class="sortable" onclick="sortTable('api-endpoints-table', 1)">Endpoint <span></span></th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="endpoint-badge get">GET</span></td>
                            <td><code>/api/tasks</code></td>
                            <td>List all tasks</td>
                        </tr>
                        <tr>
                            <td><span class="endpoint-badge get">GET</span></td>
                            <td><code>/api/tasks/{id}</code></td>
                            <td>Get task by ID</td>
                        </tr>
                        <tr>
                            <td><span class="endpoint-badge get">GET</span></td>
                            <td><code>/api/dashboard/stats</code></td>
                            <td>Get dashboard statistics</td>
                        </tr>
                        <tr>
                            <td><span class="endpoint-badge get">GET</span></td>
                            <td><code>/api/dashboard/history</code></td>
                            <td>Get recent task history</td>
                        </tr>
                        <tr>
                            <td><span class="endpoint-badge get">GET</span></td>
                            <td><code>/api/dlq/tasks</code></td>
                            <td>List all failed tasks</td>
                        </tr>
                        <tr>
                            <td><span class="endpoint-badge get">GET</span></td>
                            <td><code>/api/dlq/stats</code></td>
                            <td>Get dead letter queue statistics</td>
                        </tr>
                        <tr>
                            <td><span class="endpoint-badge post">POST</span></td>
                            <td><code>/api/tasks</code></td>
                            <td>Create a new task</td>
                        </tr>
                        <tr>
                            <td><span class="endpoint-badge post">POST</span></td>
                            <td><code>/api/dlq/tasks/{id}/retry</code></td>
                            <td>Retry a failed task</td>
                        </tr>
                        <tr>
                            <td><span class="endpoint-badge delete">DELETE</span></td>
                            <td><code>/api/dlq/tasks/{id}</code></td>
                            <td>Delete a failed task permanently</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="docs-section">
                <h3>Task Types</h3>
                <div class="task-types-grid">
                    <div class="task-type-card">
                        <h4>send_email</h4>
                        <p>Send email notifications</p>
                        <p><strong>Fields:</strong> <code>to</code>, <code>subject</code></p>
                    </div>
                    <div class="task-type-card">
                        <h4>process_image</h4>
                        <p>Process and transform images</p>
                        <p><strong>Fields:</strong> <code>image_url</code>, <code>operations</code></p>
                    </div>
                    <div class="task-type-card">
                        <h4>generate_report</h4>
                        <p>Generate reports and analytics</p>
                        <p><strong>Fields:</strong> <code>report_type</code></p>
                    </div>
                </div>
            </div>

            <div class="docs-section">
                <h3>Examples</h3>
                <div class="example-title">Create a task</div>
                <p>Schedule a task to run after a specific delay (in seconds):</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this, 0)">Copy</button>
                    <div class="code-block-editor" id="example-0"></div>
                </div>

                <div class="example-title">Schedule a task for later</div>
                <p>Schedule a task to run after a specific delay (in seconds):</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this, 1)">Copy</button>
                    <div class="code-block-editor" id="example-1"></div>
                </div>

                <div class="example-title">Process image task</div>
                <p>Create a task to process an image:</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this, 2)">Copy</button>
                    <div class="code-block-editor" id="example-2"></div>
                </div>
            </div>

            <div class="docs-section">
                <h3>Task Parameters</h3>
                <table class="params-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Type</th>
                            <th>Required</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>type</code></td>
                            <td>string</td>
                            <td>Yes</td>
                            <td>The type of task to execute</td>
                        </tr>
                        <tr>
                            <td><code>payload</code></td>
                            <td>object</td>
                            <td>Yes</td>
                            <td>Task-specific data</td>
                        </tr>
                        <tr>
                            <td><code>schedule_in</code></td>
                            <td>integer</td>
                            <td>No</td>
                            <td>Delay in seconds before execution</td>
                        </tr>
                        <tr>
                            <td><code>max_retries</code></td>
                            <td>integer</td>
                            <td>No</td>
                            <td>Maximum retry attempts (default: 3)</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.53.0/min/vs/loader.min.js"></script>
    <script src="index.js"></script>
</body>
</html>
